{
  "hash": "49a6415512c409e52f02292cdd3fb5b0",
  "result": {
    "markdown": "---\ntitle: \"Wells\"\nformat:\n  html:\n    code-fold: true\n---\n\n## Flowrate/Pressure peaks\n\nIncluding wells and perforations in the network causes more flowrate/pressure peaks past 1 kgps, which makes sense because the analogue functions were fit to data in the expected operating range, not the edge cases explored during the search. We're extrapolating instead of interpolating when we plug in low flowrates.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom matplotlib.lines import Line2D\n\ndf = pd.read_csv(\n    \"./dt/solver-out-2023-04-13_183146688_(temp=10C, inc=1)_has-Well+Perf.txt\"\n)\ndf = df.loc[df[\"FluidPressureAtReservoirBara\"] > 0.01]\nnoTwoPhase = df.loc[df[\"WasTwoPhase\"] == False]\n\ngrouped = noTwoPhase.groupby(\"InletPressureBara\")\nmaxFR = noTwoPhase.loc[\n    noTwoPhase.groupby(\"InletPressureBara\")[\"FluidPressureAtReservoirBara\"].idxmax()\n]\nmaxFR.loc[maxFR[\"InletFlowrateKgps\"] > 1]\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>InletPressureBara</th>\n      <th>InletFlowrateKgps</th>\n      <th>InletTemperatureCelsius</th>\n      <th>ReservoirPressureBara</th>\n      <th>WasTwoPhase</th>\n      <th>WasLiquid</th>\n      <th>FluidPressureAtReservoirBara</th>\n      <th>FluidTemperatureAtReservoirCelsius</th>\n      <th>FluidPhaseAtReservoir</th>\n      <th>PressureStatus</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>18082</th>\n      <td>4</td>\n      <td>2</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>False</td>\n      <td>34.999589</td>\n      <td>43.110923</td>\n      <td>Gas</td>\n      <td>Low</td>\n    </tr>\n    <tr>\n      <th>17949</th>\n      <td>5</td>\n      <td>3</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>False</td>\n      <td>34.888860</td>\n      <td>42.755118</td>\n      <td>Gas</td>\n      <td>Low</td>\n    </tr>\n    <tr>\n      <th>17816</th>\n      <td>6</td>\n      <td>4</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>False</td>\n      <td>35.245076</td>\n      <td>42.860507</td>\n      <td>Gas</td>\n      <td>Low</td>\n    </tr>\n    <tr>\n      <th>17684</th>\n      <td>7</td>\n      <td>4</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>False</td>\n      <td>33.915630</td>\n      <td>40.369753</td>\n      <td>Gas</td>\n      <td>Low</td>\n    </tr>\n    <tr>\n      <th>17551</th>\n      <td>8</td>\n      <td>5</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>False</td>\n      <td>33.849902</td>\n      <td>39.925005</td>\n      <td>Gas</td>\n      <td>Low</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>529</th>\n      <td>136</td>\n      <td>131</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>True</td>\n      <td>135.000000</td>\n      <td>10.500229</td>\n      <td>Liquid</td>\n      <td>High</td>\n    </tr>\n    <tr>\n      <th>396</th>\n      <td>137</td>\n      <td>132</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>True</td>\n      <td>135.000000</td>\n      <td>10.300497</td>\n      <td>Liquid</td>\n      <td>High</td>\n    </tr>\n    <tr>\n      <th>264</th>\n      <td>138</td>\n      <td>132</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>True</td>\n      <td>135.000000</td>\n      <td>10.248713</td>\n      <td>Liquid</td>\n      <td>High</td>\n    </tr>\n    <tr>\n      <th>132</th>\n      <td>139</td>\n      <td>132</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>True</td>\n      <td>135.000000</td>\n      <td>10.234918</td>\n      <td>Liquid</td>\n      <td>High</td>\n    </tr>\n    <tr>\n      <th>0</th>\n      <td>140</td>\n      <td>132</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>True</td>\n      <td>135.000000</td>\n      <td>10.134761</td>\n      <td>Liquid</td>\n      <td>High</td>\n    </tr>\n  </tbody>\n</table>\n<p>82 rows × 10 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\ncolors = {False: \"tab:blue\", True: \"tab:orange\"}\n\n\ndef draw_plot(df_plot, pressureBara, temperatureCelsius):\n    df_plot = df_plot.dropna()\n    df_plot = df_plot[(df_plot[\"InletPressureBara\"] == pressureBara)]\n    fig = plt.figure()\n    ax = fig.add_subplot()\n    ax.scatter(\n        df_plot[\"InletFlowrateKgps\"],\n        df_plot[\"FluidPressureAtReservoirBara\"],\n        c=df_plot[\"WasTwoPhase\"].map(colors),\n    )\n    ax.set_xlabel(\"Inlet flowrate\")\n    ax.set_ylabel(\"Outlet pressure\")\n\n    handles = [\n        Line2D(\n            [0], [0], marker=\"o\", color=\"w\", markerfacecolor=v, label=k, markersize=8\n        )\n        for k, v in colors.items()\n    ]\n    ax.legend(\n        title=\"WasTwoPhase\", handles=handles, bbox_to_anchor=(1.05, 1), loc=\"upper left\"\n    )\n    plt.grid()\n    plt.show()\n\n```\n:::\n\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\ndraw_plot(df, 77, 10)\n```\n\n::: {.cell-output .cell-output-display}\n![Well and perf - 77 Bara, 10°C](wells_files/figure-html/fig-w77bara-output-1.png){#fig-w77bara width=728 height=429}\n:::\n:::\n\n\n# [Data](dt/solver-out-2023-04-13_183146688_(temp=10C, inc=1)_has-Well+Perf.txt)\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>InletPressureBara</th>\n      <th>InletFlowrateKgps</th>\n      <th>InletTemperatureCelsius</th>\n      <th>ReservoirPressureBara</th>\n      <th>WasTwoPhase</th>\n      <th>WasLiquid</th>\n      <th>FluidPressureAtReservoirBara</th>\n      <th>FluidTemperatureAtReservoirCelsius</th>\n      <th>FluidPhaseAtReservoir</th>\n      <th>PressureStatus</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>140</td>\n      <td>132</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>True</td>\n      <td>135.000000</td>\n      <td>10.134761</td>\n      <td>Liquid</td>\n      <td>High</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>140</td>\n      <td>131</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>True</td>\n      <td>135.000000</td>\n      <td>10.089780</td>\n      <td>Liquid</td>\n      <td>High</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>140</td>\n      <td>130</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>True</td>\n      <td>135.000000</td>\n      <td>10.162974</td>\n      <td>Liquid</td>\n      <td>High</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>140</td>\n      <td>129</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>True</td>\n      <td>135.000000</td>\n      <td>10.170906</td>\n      <td>Liquid</td>\n      <td>High</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>140</td>\n      <td>128</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>True</td>\n      <td>134.999422</td>\n      <td>9.978292</td>\n      <td>Liquid</td>\n      <td>High</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>17951</th>\n      <td>5</td>\n      <td>1</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>False</td>\n      <td>34.384404</td>\n      <td>41.278461</td>\n      <td>Gas</td>\n      <td>Low</td>\n    </tr>\n    <tr>\n      <th>18082</th>\n      <td>4</td>\n      <td>2</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>False</td>\n      <td>34.999589</td>\n      <td>43.110923</td>\n      <td>Gas</td>\n      <td>Low</td>\n    </tr>\n    <tr>\n      <th>18083</th>\n      <td>4</td>\n      <td>1</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>False</td>\n      <td>34.816496</td>\n      <td>42.440157</td>\n      <td>Gas</td>\n      <td>Low</td>\n    </tr>\n    <tr>\n      <th>18215</th>\n      <td>3</td>\n      <td>1</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>False</td>\n      <td>35.315295</td>\n      <td>43.755330</td>\n      <td>Gas</td>\n      <td>Low</td>\n    </tr>\n    <tr>\n      <th>18347</th>\n      <td>2</td>\n      <td>1</td>\n      <td>10</td>\n      <td>40</td>\n      <td>False</td>\n      <td>False</td>\n      <td>35.964165</td>\n      <td>45.193010</td>\n      <td>Gas</td>\n      <td>Low</td>\n    </tr>\n  </tbody>\n</table>\n<p>10326 rows × 10 columns</p>\n</div>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "wells_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}